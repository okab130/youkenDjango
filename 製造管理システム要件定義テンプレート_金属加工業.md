# Djangoベース製造管理システム 要件定義テンプレート（金属加工業特化）

## 1. プロジェクト基本情報

### 1.1 プロジェクト概要
- **システム名称**: [例: MetalFlow - 金属加工製造管理システム]
- **目的**: [例: 生産進捗可視化、品質向上、納期遵守、原価削減]
- **対象業種**: [金属加工業 / プレス加工 / 切削加工 / 板金加工 / 鋳造 / 鍛造]
- **企業規模**: [例: 中小企業 / 中堅企業]
- **生産方式**: 
  - [ ] 受注生産（個別生産）
  - [ ] 繰り返し受注生産（多品種少量）
  - [ ] 見込生産（少品種多量）
  - [ ] 複合（受注+見込）
- **生産規模**: 
  - 月間生産数: [例: ○個/○ロット]
  - 管理品目数: [例: ○品目]
  - 工程数: [例: ○工程]
  - 設備台数: [例: ○台]
  - 作業者数: [例: ○名]
- **想定ユーザー数**: [例: 生産管理5名、現場作業20名、品質管理3名、経営層2名]
- **開発フェーズ**: [プロトタイプ / MVP / 本番環境]

### 1.2 製造管理システムの範囲定義（該当するものに✓）

#### A. 生産計画管理
- [ ] **受注・内示管理**
  - [ ] 受注登録（数量・納期・仕様）
  - [ ] 内示情報管理
  - [ ] 受注残管理
  - [ ] 納期回答（負荷状況確認）

- [ ] **生産計画立案**
  - [ ] 月次生産計画
  - [ ] 週次生産計画
  - [ ] 日次生産計画
  - [ ] 生産能力（キャパシティ）管理
  - [ ] 負荷山積み/山崩し
  - [ ] 制約条件管理（段取り時間、設備能力等）

- [ ] **MRP（資材所要量計画）**
  - [ ] BOM（部品表）展開
  - [ ] 所要量計算
  - [ ] 発注提案生成
  - [ ] 在庫引当

#### B. 製造指示・実績管理
- [ ] **製造指示**
  - [ ] 製造指図書発行
  - [ ] 作業指示書発行
  - [ ] 図面・仕様書連携
  - [ ] QRコード/バーコード発行
  - [ ] 段取り指示

- [ ] **実績収集**
  - [ ] 作業開始/完了報告
  - [ ] 実績数量入力
  - [ ] 不良数・手直し数記録
  - [ ] 作業時間記録（工数実績）
  - [ ] 設備稼働実績
  - [ ] バーコード/タッチパネル入力

- [ ] **進捗管理**
  - [ ] リアルタイム進捗表示
  - [ ] 工程別進捗率
  - [ ] ガントチャート表示
  - [ ] 遅延アラート
  - [ ] 完成予定日計算

#### C. 工程管理
- [ ] **工程マスタ**
  - [ ] 工程定義（切断→曲げ→溶接→表面処理等）
  - [ ] 標準工数設定
  - [ ] 工程順序管理
  - [ ] 工程間リードタイム
  - [ ] 外注工程管理

- [ ] **工程別管理**
  - [ ] 切削加工管理（NC工作機械連携）
  - [ ] プレス加工管理（金型管理）
  - [ ] 溶接管理（溶接条件記録）
  - [ ] 表面処理管理（メッキ、塗装等）
  - [ ] 熱処理管理（温度・時間記録）
  - [ ] 検査工程管理

#### D. 品質管理
- [ ] **検査管理**
  - [ ] 受入検査（材料検収）
  - [ ] 工程内検査（中間検査）
  - [ ] 完成品検査（出荷検査）
  - [ ] 検査基準管理
  - [ ] 検査記録（検査成績書）
  - [ ] サンプリング検査

- [ ] **不良管理**
  - [ ] 不良品記録
  - [ ] 不良原因分析
  - [ ] 是正処置（CAPA）
  - [ ] 不良率集計
  - [ ] パレート図・ヒストグラム

- [ ] **トレーサビリティ**
  - [ ] ロット番号管理
  - [ ] 製造番号（シリアル番号）管理
  - [ ] 使用材料追跡
  - [ ] 作業者追跡
  - [ ] 設備追跡
  - [ ] 検査結果追跡

#### E. 設備管理
- [ ] **設備稼働管理**
  - [ ] 設備稼働状況表示
  - [ ] 稼働率・可動率計算
  - [ ] 停止時間記録
  - [ ] チョコ停記録
  - [ ] IoT連携（稼働センサー）

- [ ] **保全管理**
  - [ ] 定期保全計画
  - [ ] 予防保全スケジュール
  - [ ] 保全実績記録
  - [ ] 部品交換履歴
  - [ ] 故障履歴・MTBF/MTTR

- [ ] **金型管理（プレス・鋳造の場合）**
  - [ ] 金型台帳
  - [ ] 金型使用実績（ショット数）
  - [ ] 金型メンテナンス
  - [ ] 金型寿命管理

#### F. 原価管理
- [ ] **標準原価管理**
  - [ ] 材料費（BOM展開）
  - [ ] 加工費（工数×時間単価）
  - [ ] 外注費
  - [ ] 経費配賦

- [ ] **実際原価管理**
  - [ ] 実績材料費
  - [ ] 実績加工費
  - [ ] 実績外注費
  - [ ] 原価差異分析

- [ ] **見積原価**
  - [ ] 見積原価計算
  - [ ] 利益率計算
  - [ ] 見積書発行

#### G. 材料管理
- [ ] **材料所要量計算**
  - [ ] BOM展開
  - [ ] 歩留まり考慮
  - [ ] ロス率設定
  - [ ] ネスティング（板取り最適化）

- [ ] **材料在庫管理**
  - [ ] 材料入庫
  - [ ] 材料払出
  - [ ] 材料在庫照会
  - [ ] 材料ロット管理
  - [ ] ミルシート管理（材料証明書）

#### H. 外注管理
- [ ] **外注発注**
  - [ ] 外注先選定
  - [ ] 外注発注書発行
  - [ ] 外注納期管理

- [ ] **外注進捗管理**
  - [ ] 外注先進捗確認
  - [ ] 外注品入荷
  - [ ] 外注品検査

#### I. 作業者管理・工数管理
- [ ] **作業者マスタ**
  - [ ] 作業者情報
  - [ ] スキルマトリックス（技能レベル）
  - [ ] 資格管理（溶接資格等）
  - [ ] シフト管理

- [ ] **工数実績**
  - [ ] 作業時間記録
  - [ ] 直接工数/間接工数
  - [ ] 残業時間
  - [ ] 工数集計・分析

#### J. 図面・仕様管理
- [ ] **図面管理**
  - [ ] 図面登録（PDF、CADデータ）
  - [ ] 図面バージョン管理
  - [ ] 図面改訂履歴
  - [ ] 図面閲覧（現場タブレット）

- [ ] **仕様書管理**
  - [ ] 加工仕様書
  - [ ] 検査仕様書
  - [ ] 作業標準書

#### K. 分析・レポート
- [ ] **生産分析**
  - [ ] 生産実績推移
  - [ ] 稼働率分析
  - [ ] 納期遵守率
  - [ ] リードタイム分析

- [ ] **品質分析**
  - [ ] 不良率推移
  - [ ] 工程別不良率
  - [ ] パレート図
  - [ ] 管理図（Xbar-R図等）

- [ ] **原価分析**
  - [ ] 品目別原価分析
  - [ ] 工程別原価分析
  - [ ] 原価差異分析

---

## 2. ビジネス要件

### 2.1 解決したい課題（優先度: 高/中/低）
| 課題 | 現状 | 理想 | 優先度 |
|------|------|------|--------|
| [例: 生産進捗の不透明性] | [現場に聞かないとわからない] | [リアルタイム進捗可視化] | 高 |
| [例: 納期遅延の頻発] | [月○件の納期遅延] | [納期遵守率95%以上] | 高 |
| [例: 設備故障による停止] | [月○回の突発故障] | [予防保全で計画停止のみ] | 高 |
| [例: 不良率の高さ] | [不良率○%、手直しコスト大] | [不良率○%以下] | 高 |
| [例: 原価の不透明性] | [見積と実際原価が乖離] | [リアルタイム原価把握] | 中 |
| [例: 図面探しに時間] | [紙図面、探すのに○分] | [タブレットで即座に閲覧] | 中 |
| [例: 材料の過剰在庫] | [総材料在庫○億円] | [適正在庫、○%削減] | 中 |
| | | | |

### 2.2 主要ユーザーロール
| ロール名 | 主な業務 | 権限レベル | 人数 | 利用デバイス |
|----------|----------|------------|------|--------------|
| [例: 生産管理担当] | [生産計画立案、製造指示] | [計画・指示] | [5名] | [PC] |
| [例: 現場作業者] | [実績入力、作業報告] | [実績入力] | [20名] | [タブレット/PC] |
| [例: 現場リーダー] | [進捗確認、指示調整] | [進捗管理] | [3名] | [PC/タブレット] |
| [例: 品質管理担当] | [検査、不良分析] | [品質管理] | [3名] | [PC/タブレット] |
| [例: 設備保全担当] | [設備保全、故障対応] | [設備管理] | [2名] | [PC/タブレット] |
| [例: 経営層] | [KPI確認、意思決定] | [全データ参照] | [2名] | [PC/タブレット] |
| | | | | |

### 2.3 業務フロー（代表的なもの）

#### フロー1: 受注から製造指示まで（受注生産の場合）
```
1. 営業が受注（数量・納期・仕様）
2. 生産管理が受注登録
3. 負荷状況確認（納期回答可否判断）
4. 生産計画立案（山積み/山崩し）
5. MRP展開（所要量計算）
6. 材料発注（不足材料）
7. 製造指図書発行
8. 現場へ作業指示
```

#### フロー2: 製造実績収集フロー
```
1. 作業者が製造指図書受領
2. 図面・仕様書確認（タブレット閲覧）
3. 材料・治具準備
4. 作業開始報告（バーコードスキャン/タッチパネル）
5. 加工作業実施
6. 工程内検査
7. 作業完了報告（実績数量・工数入力）
8. 次工程へ引き渡し
9. システムで進捗自動更新
```

#### フロー3: 品質管理フロー
```
【受入検査】
1. 材料入荷
2. 受入検査実施（寸法・硬度・ミルシート確認）
3. 検査結果入力
4. 合格品は倉庫へ、不良品は返品

【工程内検査】
1. 加工完了
2. 自主検査 or 専任検査員
3. 検査記録入力
4. 不良品は手直し or 廃棄

【完成品検査】
1. 最終工程完了
2. 出荷検査（寸法、外観、機能）
3. 検査成績書発行
4. 合格品は出荷、不良品は手直し
```

#### フロー4: 設備保全フロー
```
【予防保全】
1. システムが保全予定日を通知
2. 保全担当が保全計画確認
3. 生産計画と調整（停止時間確保）
4. 保全作業実施
5. 保全実績入力（作業内容、部品交換）
6. 次回保全日を自動計算

【突発故障】
1. 設備停止
2. 故障報告（停止時刻、症状）
3. 保全担当が復旧作業
4. 復旧報告（復旧時刻、原因、対策）
5. 故障履歴記録
6. MTBF/MTTR更新
```

#### フロー5: 原価計算フロー
```
【標準原価設定】
1. BOM登録（部品構成）
2. 工程別標準工数設定
3. 材料単価設定
4. 時間単価設定
5. 標準原価自動計算

【実際原価計算】
1. 材料払出実績取得
2. 工数実績取得
3. 外注費実績取得
4. 実際原価計算
5. 原価差異分析（標準 vs 実際）
6. 差異原因調査
```

#### フロー6: ロット追跡フロー（トレーサビリティ）
```
【フォワードトレース（追跡）】
1. 材料ロット番号指定
2. どの製造番号の製品に使用されたか確認
3. 出荷先確認

【バックワードトレース（遡及）】
1. 製造番号指定
2. 使用材料ロット確認
3. 加工日時・作業者確認
4. 使用設備確認
5. 検査結果確認
6. 問題発生時はリコール対応
```

**記載してください:**
- [ ] 受注～製造指示フロー
- [ ] 製造実績収集フロー
- [ ] 品質管理フロー
- [ ] 設備保全フロー
- [ ] 原価計算フロー
- [ ] ロット追跡フロー
- [ ] その他重要フロー

---

## 3. 機能要件

### 3.1 必須機能（MVP）
| 機能カテゴリ | 機能名 | 詳細 | 優先度 |
|--------------|--------|------|--------|
| 受注管理 | 受注登録 | 数量・納期・仕様入力 | 必須 |
| | 受注一覧 | 検索・絞込 | 必須 |
| 生産計画 | 生産計画立案 | 週次・日次計画 | 必須 |
| | 負荷状況確認 | 設備別負荷表示 | 必須 |
| 製造指示 | 製造指図書発行 | PDF出力、QRコード | 必須 |
| | 作業指示一覧 | 未着手・進行中・完了 | 必須 |
| 実績管理 | 作業開始報告 | バーコードスキャン | 必須 |
| | 作業完了報告 | 実績数量・工数入力 | 必須 |
| | 実績一覧 | 日次・週次集計 | 必須 |
| 進捗管理 | リアルタイム進捗 | 工程別進捗率表示 | 必須 |
| | ガントチャート | 視覚的進捗管理 | 高 |
| | 遅延アラート | 納期遅延予測通知 | 高 |
| 工程管理 | 工程マスタ | 工程定義、標準工数 | 必須 |
| | 工程別実績 | 工程別生産数・工数 | 必須 |
| 品質管理 | 検査記録入力 | 合格・不良判定 | 必須 |
| | 不良記録 | 不良数・不良原因 | 必須 |
| | 検査成績書発行 | PDF出力 | 高 |
| 設備管理 | 設備稼働実績 | 稼働時間・停止時間 | 高 |
| | 保全計画 | 定期保全スケジュール | 高 |
| BOM管理 | BOM登録 | 部品構成表 | 必須 |
| | BOM展開 | 所要量計算 | 必須 |
| 材料管理 | 材料在庫照会 | ロット別在庫 | 必須 |
| | 材料払出 | 製造指図紐付け | 必須 |
| 原価管理 | 標準原価設定 | 材料費+加工費 | 高 |
| | 実際原価計算 | 実績ベース原価 | 高 |
| マスタ管理 | 品目マスタ | 製品・部品・材料 | 必須 |
| | 設備マスタ | 設備情報 | 必須 |
| | 作業者マスタ | 作業者・スキル | 必須 |
| レポート | 生産実績表 | 日次・月次集計 | 必須 |
| | 不良率推移 | グラフ表示 | 高 |

**追加機能を記載:**
| | | | |

### 3.2 将来対応機能（Phase 2以降）
- [ ] **IoT連携** - 設備稼働センサー、温度センサー等
- [ ] **AI品質予測** - 機械学習による不良予測
- [ ] **画像検査** - AIによる外観検査自動化
- [ ] **NC工作機械連携** - DNC通信、NCプログラム送信
- [ ] **3Dビューワー** - 3D CADデータ閲覧
- [ ] **VR/AR作業支援** - AR作業ガイド表示
- [ ] **ブロックチェーン証跡** - トレーサビリティ強化
- [ ] **予知保全** - 設備故障予測
- [ ] **自動スケジューリング** - AI最適生産計画
- [ ] **デジタルツイン** - 仮想工場シミュレーション

---

## 4. 非機能要件

### 4.1 性能要件
- **同時アクセス数**: [例: 最大50ユーザー（現場作業者含む）]
- **レスポンスタイム**: 
  - 進捗照会: [例: 3秒以内]
  - 実績登録: [例: 5秒以内]
  - ガントチャート表示: [例: 10秒以内]
- **データ保持期間**: [例: 製造実績10年間保持（トレーサビリティ）]
- **データ量見積**: 
  - 月間製造指図数: [例: 1,000件]
  - 年間実績レコード: [例: 50,000件]

### 4.2 セキュリティ要件
- [ ] **認証**
  - ユーザー認証: [Django標準認証 / LDAP]
  - 現場タブレット認証: [PIN / バーコード]
  
- [ ] **権限管理**
  - ロールベースアクセス制御（RBAC）
  - 工場別データ分離
  - 図面閲覧権限管理
  - 操作ログ記録
  
- [ ] **データ保護**
  - 製造データの暗号化
  - バックアップ（日次）
  - トレーサビリティデータの改ざん防止

### 4.3 可用性要件
- **稼働時間**: [例: 24時間365日（3交代制）]
- **目標稼働率**: [例: 99.5%]
- **保守時間**: [例: 月1回、日曜深夜2時間]

### 4.4 データ整合性要件
- [ ] **生産実績の正確性** - 二重登録防止
- [ ] **トランザクション整合性** - 材料払出と在庫の整合性
- [ ] **トレーサビリティ完全性** - ロット情報の欠損なし

---

## 5. データモデル要件

### 5.1 主要エンティティ（想定）

#### 受注（Order）
- [ ] 受注ID
- [ ] 受注番号
- [ ] 受注日
- [ ] 顧客（外部キー）
- [ ] 品目（外部キー）
- [ ] 受注数量
- [ ] 納期
- [ ] 仕様（特記事項）
- [ ] ステータス（受注/計画中/製造中/完了/出荷済）
- [ ] その他: ___________

#### 製造指図（ProductionOrder）
- [ ] 製造指図ID
- [ ] 製造指図番号（自動採番）
- [ ] 受注（外部キー、任意）
- [ ] 品目（外部キー）
- [ ] 製造数量
- [ ] 開始予定日
- [ ] 完了予定日
- [ ] 優先度
- [ ] ステータス（未着手/進行中/完了/中止）
- [ ] 製造ロット番号
- [ ] 備考
- [ ] その他: ___________

#### 工程実績（ProcessRecord）
- [ ] 工程実績ID
- [ ] 製造指図（外部キー）
- [ ] 工程（外部キー）
- [ ] 設備（外部キー）
- [ ] 作業者（外部キー）
- [ ] 開始日時
- [ ] 完了日時
- [ ] 実績数量
- [ ] 良品数
- [ ] 不良数
- [ ] 手直し数
- [ ] 工数（時間）
- [ ] ステータス（未着手/進行中/完了）
- [ ] その他: ___________

#### BOM（部品表、BillOfMaterials）
- [ ] BOM ID
- [ ] 親品目（外部キー）
- [ ] 子品目（外部キー、部品・材料）
- [ ] 使用数量
- [ ] 単位
- [ ] 歩留まり率（%）
- [ ] ロス率（%）
- [ ] 有効開始日
- [ ] 有効終了日
- [ ] その他: ___________

#### 工程マスタ（Process）
- [ ] 工程ID
- [ ] 工程コード
- [ ] 工程名（切断/曲げ/溶接/研磨等）
- [ ] 工程種別（内作/外注）
- [ ] 標準工数（時間/個）
- [ ] 段取り時間（分）
- [ ] 使用設備（外部キー）
- [ ] 作業標準書URL
- [ ] 表示順序
- [ ] ステータス（有効/無効）
- [ ] その他: ___________

#### 品目マスタ（Item）
- [ ] 品目ID
- [ ] 品目コード
- [ ] 品目名
- [ ] 品目区分（製品/部品/材料）
- [ ] 仕様・規格
- [ ] 単位
- [ ] 図面番号
- [ ] 図面ファイルURL
- [ ] 標準原価
- [ ] リードタイム（日数）
- [ ] ロット管理フラグ
- [ ] ステータス（有効/廃番）
- [ ] その他: ___________

#### 設備マスタ（Equipment）
- [ ] 設備ID
- [ ] 設備コード
- [ ] 設備名
- [ ] 設備種別（NC旋盤/プレス機/溶接機等）
- [ ] 設備能力（個/時間）
- [ ] 導入日
- [ ] メーカー・型式
- [ ] 保全周期（日数）
- [ ] 次回保全予定日
- [ ] ステータス（稼働中/停止中/保全中/故障中）
- [ ] その他: ___________

#### 作業者マスタ（Worker）
- [ ] 作業者ID
- [ ] 従業員番号
- [ ] 氏名
- [ ] 所属部署
- [ ] 技能レベル（A/B/C等）
- [ ] 保有資格（溶接資格等）
- [ ] 時間単価
- [ ] ステータス（在籍/退職）
- [ ] その他: ___________

#### 検査記録（InspectionRecord）
- [ ] 検査記録ID
- [ ] 製造指図（外部キー）
- [ ] 検査種別（受入/工程内/完成品）
- [ ] 検査日時
- [ ] 検査者（外部キー）
- [ ] 検査項目（寸法/硬度/外観等）
- [ ] 検査結果（合格/不合格）
- [ ] 測定値
- [ ] 規格値（上限/下限）
- [ ] 不良内容
- [ ] 不良原因
- [ ] 処置（手直し/廃棄/特採）
- [ ] その他: ___________

#### 設備稼働記録（EquipmentLog）
- [ ] 稼働記録ID
- [ ] 設備（外部キー）
- [ ] 製造指図（外部キー、任意）
- [ ] 稼働開始日時
- [ ] 稼働終了日時
- [ ] 稼働時間（分）
- [ ] 停止時間（分）
- [ ] 停止理由（段取り/故障/休憩等）
- [ ] 生産数量
- [ ] その他: ___________

#### 保全記録（MaintenanceRecord）
- [ ] 保全記録ID
- [ ] 設備（外部キー）
- [ ] 保全種別（定期/予防/突発）
- [ ] 保全日
- [ ] 保全担当者（外部キー）
- [ ] 保全内容
- [ ] 交換部品
- [ ] 保全時間（分）
- [ ] 次回保全予定日
- [ ] その他: ___________

#### 材料払出記録（MaterialIssue）
- [ ] 払出記録ID
- [ ] 製造指図（外部キー）
- [ ] 材料品目（外部キー）
- [ ] 材料ロット番号
- [ ] 払出数量
- [ ] 払出日時
- [ ] ミルシート番号（材料証明書）
- [ ] その他: ___________

### 5.2 追加エンティティ
必要に応じて追加してください:
- [ ] 金型マスタ（金型管理）
- [ ] 治具マスタ（治工具管理）
- [ ] 外注先マスタ
- [ ] 検査基準マスタ
- [ ] 不良原因マスタ
- [ ] 停止理由マスタ
- [ ] 生産計画（週次・日次）
- [ ] その他: ___________

---

## 6. 画面要件

### 6.1 必須画面リスト（PC - 生産管理部門）

| 画面カテゴリ | 画面名 | 主要機能 | アクセス権限 |
|--------------|--------|----------|--------------|
| ダッシュボード | 生産状況ダッシュボード | 稼働率・進捗率・KPI | 全ユーザー |
| | 設備稼働状況 | リアルタイム稼働表示 | 生産管理・経営層 |
| 受注管理 | 受注一覧 | 検索・絞込 | 生産管理 |
| | 受注登録 | 数量・納期・仕様入力 | 生産管理 |
| | 受注残一覧 | 未完了受注 | 生産管理 |
| 生産計画 | 生産計画立案 | 週次・日次計画 | 生産管理 |
| | 負荷山積み表 | 設備別負荷グラフ | 生産管理 |
| | 山崩し調整 | 手動スケジュール調整 | 生産管理 |
| 製造指示 | 製造指図一覧 | 検索・絞込、ステータス | 生産管理・現場 |
| | 製造指図発行 | 指図書PDF出力 | 生産管理 |
| | 作業指示書発行 | 工程別作業指示 | 生産管理 |
| 進捗管理 | リアルタイム進捗 | 製造指図別進捗率 | 全ユーザー |
| | ガントチャート | 視覚的進捗管理 | 生産管理・現場 |
| | 遅延アラート一覧 | 納期遅延予測 | 生産管理 |
| 実績管理 | 実績一覧 | 日次・週次集計 | 生産管理 |
| | 工程別実績 | 工程別生産数・工数 | 生産管理 |
| 品質管理 | 検査記録一覧 | 検索・絞込 | 品質管理 |
| | 検査記録入力 | 検査結果入力 | 品質管理 |
| | 不良分析 | パレート図、推移グラフ | 品質管理・経営層 |
| | 検査成績書発行 | PDF出力 | 品質管理 |
| 設備管理 | 設備稼働実績 | 稼働率・可動率 | 設備保全 |
| | 保全計画一覧 | 保全スケジュール | 設備保全 |
| | 保全実績入力 | 保全内容記録 | 設備保全 |
| | 故障履歴 | MTBF/MTTR分析 | 設備保全 |
| BOM管理 | BOM一覧 | 品目別BOM | 生産管理 |
| | BOM登録・編集 | 部品構成登録 | 生産管理 |
| | BOM展開 | 所要量計算 | 生産管理 |
| 材料管理 | 材料在庫一覧 | ロット別在庫 | 生産管理・現場 |
| | 材料払出入力 | 製造指図紐付け | 現場 |
| 原価管理 | 標準原価一覧 | 品目別標準原価 | 生産管理 |
| | 実際原価計算 | 製造指図別原価 | 生産管理・経営層 |
| | 原価差異分析 | 標準 vs 実際 | 経営層 |
| マスタ管理 | 品目マスタ | CRUD操作 | 生産管理 |
| | 工程マスタ | CRUD操作 | 生産管理 |
| | 設備マスタ | CRUD操作 | 設備保全 |
| | 作業者マスタ | CRUD操作、スキル管理 | 管理者 |
| レポート | 生産実績表 | 日次・月次集計 | 全ユーザー |
| | 不良率推移 | グラフ表示 | 品質管理・経営層 |
| | 稼働率推移 | 設備別稼働率 | 設備保全・経営層 |
| | 納期遵守率 | KPI表示 | 経営層 |

### 6.2 必須画面リスト（タブレット - 現場用）

| 画面名 | 主要機能 | デバイス |
|--------|----------|----------|
| ログイン | PIN/バーコード認証 | タブレット |
| 作業指示一覧 | 本日の作業指示 | タブレット |
| 図面閲覧 | PDF/CAD図面表示 | タブレット |
| 作業開始報告 | QRスキャン、開始時刻 | タブレット |
| 作業完了報告 | 実績数量・工数入力 | タブレット |
| 不良品記録 | 不良数・原因入力 | タブレット |
| 検査記録入力 | 検査結果入力 | タブレット |
| 設備稼働報告 | 稼働/停止記録 | タブレット |

### 6.3 画面の優先度
- **Phase 1 (MVP)**: 
  - [受注管理、製造指示、実績管理、進捗管理、BOM管理、品目マスタ]
- **Phase 2**: 
  - [生産計画、品質管理、設備管理、材料管理、タブレット画面]
- **Phase 3**: 
  - [原価管理、高度分析、IoT連携]

---

## 7. UI/UX要件

### 7.1 PC画面デザイン方針
- [ ] シンプル・直感的（生産管理者向け）
- [ ] レスポンシブデザイン（PC優先、タブレット対応）
- [ ] カラースキーム: [例: 稼働中=緑、停止=赤、警告=黄]
- [ ] リアルタイム更新（WebSocket or ポーリング）

### 7.2 タブレット画面デザイン方針（現場用）
- [ ] **大きなボタン** - タッチしやすい（最小44×44px）
- [ ] **最小限の入力** - QRスキャン中心
- [ ] **音声フィードバック** - 登録成功・エラー音
- [ ] **オフライン対応** - Wi-Fi切れても動作
- [ ] **防水・防塵対応** - 工場環境に適した端末

### 7.3 操作性要件
- [ ] **QRコード/バーコードスキャン** - 高速実績入力
- [ ] **ドラッグ&ドロップ** - スケジュール調整
- [ ] **リアルタイムグラフ** - Chart.js等
- [ ] **図面ビューワー** - PDF拡大縮小、CAD表示

---

## 8. 外部連携要件

### 8.1 販売管理システム連携
- [ ] **受注データ取込** - 自動製造指図生成

### 8.2 購買管理システム連携
- [ ] **材料発注連携** - MRP所要量から発注

### 8.3 在庫管理システム連携
- [ ] **材料在庫照会** - リアルタイム在庫確認
- [ ] **材料払出連携** - 在庫自動減算

### 8.4 会計システム連携
- [ ] **原価データ提供** - 製造原価計上

### 8.5 NC工作機械連携（高度）
- [ ] **DNC通信** - NCプログラム送信
- [ ] **稼働データ取得** - 加工開始/完了自動取得

### 8.6 IoTセンサー連携
- [ ] **設備稼働センサー** - 稼働/停止自動記録
- [ ] **温度センサー** - 熱処理温度記録

---

## 9. 技術要件

### 9.1 Django技術スタック
- **Djangoバージョン**: [例: Django 4.2 LTS]
- **Python バージョン**: [例: Python 3.11]
- **データベース**: [PostgreSQL]
- **キャッシュ**: [Redis（リアルタイム進捗）]
- **タスクキュー**: [Celery + Redis（MRP計算、レポート生成）]
- **リアルタイム通信**: [Django Channels（WebSocket）]
- **ストレージ**: [AWS S3 / ローカル（図面・写真保存）]

### 9.2 フロントエンド
- **テンプレートエンジン**: Django Templates
- **CSSフレームワーク**: [Bootstrap 5]
- **JavaScript**: [Vue.js / React（ガントチャート、リアルタイム更新）]
- **ガントチャート**: [DHTMLX Gantt / FullCalendar]
- **グラフ**: [Chart.js / Highcharts]
- **PDF生成**: [WeasyPrint / ReportLab]
- **QRコード生成**: [qrcode / python-barcode]
- **図面ビューワー**: [PDF.js]

### 9.3 製造管理特有の技術
- **MRP計算**: Celeryバックグラウンドタスク
- **スケジューリングアルゴリズム**: 山積み/山崩しロジック
- **トランザクション管理**: @transaction.atomic

### 9.4 認証・認可
- **認証方式**: [Django標準認証 / LDAP]
- **権限管理**: [Django標準Permissions + カスタムPermission]

### 9.5 開発・運用ツール
- **バージョン管理**: Git
- **CI/CD**: [GitHub Actions / GitLab CI]
- **デプロイ先**: [AWS / オンプレミス]
- **Webサーバー**: [Nginx + Gunicorn]
- **監視**: [Sentry / Datadog]

---

## 10. 制約・前提条件

### 10.1 プロジェクト制約
- **予算**: [例: 開発費○○万円、運用費月○○円]
- **納期**: [例: 1年でMVPリリース]
- **開発体制**: [例: バックエンド3名、フロント2名、製造業経験者1名]
- **既存システム**: [例: 現行Excel+紙管理、データ移行必要]

### 10.2 技術的制約
- [ ] オンプレミス環境必須（工場内ネットワーク）
- [ ] タブレット対応必須（現場作業者用）
- [ ] オフライン動作必須（ネットワーク不安定）
- [ ] その他: ___________

### 10.3 業務的制約
- [ ] 生産を止められない（段階的導入）
- [ ] 現場作業者のITリテラシー低い
- [ ] 3交代制（24時間稼働）
- [ ] その他: ___________

---

## 11. リスクと対応策

| リスク | 影響度 | 発生確率 | 対応策 |
|--------|--------|----------|--------|
| [例: データ移行失敗] | 極大 | 中 | 段階的移行、十分な検証期間 |
| [例: 現場の抵抗感] | 高 | 高 | 十分な教育訓練、現場巻き込み |
| [例: タブレット故障] | 中 | 中 | 予備機確保、紙への切り替え手順 |
| [例: ネットワーク障害] | 高 | 中 | オフライン動作、復旧時同期 |
| [例: MRP計算負荷] | 中 | 中 | Celery非同期処理、夜間実行 |
| | | | |

---

## 12. 成功基準（KPI）

### 12.1 定量的指標
- [ ] **納期遵守率**: [現状○% → 目標95%以上]
- [ ] **設備稼働率**: [現状○% → 目標85%以上]
- [ ] **不良率**: [現状○% → 目標1%以下]
- [ ] **生産リードタイム**: [現状○日 → 目標○日（30%短縮）]
- [ ] **実績入力時間**: [現状○分/件 → 目標○秒/件]
- [ ] **在庫回転率**: [現状○回 → 目標○回]

### 12.2 定性的指標
- [ ] リアルタイムな生産進捗把握
- [ ] 現場の負担軽減（ペーパーレス）
- [ ] トレーサビリティ強化
- [ ] 原価の見える化
- [ ] 経営判断の迅速化

---

## 13. 移行計画

### 13.1 データ移行
- **移行対象データ**: 
  - [品目マスタ: ○件]
  - [BOM: ○件]
  - [設備マスタ: ○件]
  - [過去実績（直近○ヶ月分）]
- **移行方法**: [CSV一括登録 / 手動入力]
- **移行タイミング**: [長期休暇中（GW、年末年始）]

### 13.2 段階的移行計画
```
Phase 1: パイロット工程（2ヶ月）
  - 1工程で試験運用
  - 新旧システム並行稼働
  - 問題点洗い出し

Phase 2: 全工程展開（4ヶ月）
  - 全工程へ展開
  - タブレット配布
  - 旧システム併用

Phase 3: 完全移行（2ヶ月）
  - 紙帳票廃止
  - 本格運用開始
```

### 13.3 教育訓練
- **現場作業者向け**: [タブレット操作研修2時間、実地研修]
- **生産管理担当向け**: [システム全体研修2日間]
- **経営層向け**: [ダッシュボード研修1時間]
- **マニュアル**: [操作マニュアル、FAQ、動画]

---

## 14. 金属加工業特有の考慮事項

### 14.1 加工方式別の特性
- **切削加工**: NC工作機械連携、工具管理、切粉処理
- **プレス加工**: 金型管理、金型寿命、段取り替え時間
- **溶接**: 溶接資格管理、溶接条件記録、ビード検査
- **表面処理**: メッキ・塗装の管理、処理時間・温度記録
- **熱処理**: 炉温度・時間記録、硬度検査

### 14.2 材料特性
- **鉄鋼**: ミルシート管理、材質記号（SS400、S45C等）
- **ステンレス**: SUS304/316等、耐食性管理
- **アルミ**: A5052/A6061等、軽量化要求
- **非鉄**: 銅、真鍮、チタン等

### 14.3 品質要求
- **寸法精度**: 公差管理（±0.1mm等）
- **表面粗さ**: Ra値管理
- **硬度**: HRC、HV管理
- **材料証明**: ミルシート、材料証明書

---

## 15. 次のステップ

このテンプレートを埋めた後、以下の順序で設計を進めます:

### Step 1: 要件確認・曖昧性解消
- 記載内容の矛盾チェック
- 現場担当者へのヒアリング（加工方式、工程フロー）
- 優先機能の確定

### Step 2: データモデル設計（models.py）
- ER図作成
- Djangoモデル定義
- BOM階層構造設計
- トレーサビリティ設計

### Step 3: 機能設計
- URLルーティング設計
- ビュー設計（CBV）
- MRP計算ロジック設計
- スケジューリングアルゴリズム設計

### Step 4: UI設計書作成
- ワイヤーフレーム（PC/タブレット）
- ガントチャート設計
- ダッシュボード設計

### Step 5: 外部連携設計
- 販売・購買システムAPI仕様確認
- NC工作機械連携方式（DNC等）
- IoTセンサー連携方式

---

## 記入ガイド

### 🔴 必須項目（絶対に明確化すべき）
- 生産方式（受注生産/見込生産）
- 加工方式（切削/プレス/溶接等）
- 主要工程フロー
- BOM構成
- トレーサビリティ要件
- 主要ユーザーロール
- 必須機能（MVP）

### 🟡 重要項目（早期に決定すべき）
- 外部連携要件（販売・購買・在庫）
- タブレット要件
- 品質管理要件（検査項目）
- 設備管理要件（保全計画）
- 非機能要件（性能・可用性）

### 🟢 推奨項目（設計品質向上）
- 業務フロー詳細化
- IoT連携要否
- NC工作機械連携要否
- リスクと対応策
- 段階的移行計画

---

## 製造管理システム特有のチェックリスト

### ✅ BOM管理を考慮しているか
- [ ] 部品構成（親子関係）
- [ ] 所要量計算（MRP）
- [ ] 歩留まり・ロス率
- [ ] BOM展開の性能

### ✅ トレーサビリティを考慮しているか
- [ ] ロット番号管理
- [ ] 製造番号（シリアル）管理
- [ ] 使用材料追跡
- [ ] 作業者・設備追跡

### ✅ リアルタイム性を考慮しているか
- [ ] 進捗のリアルタイム更新
- [ ] 設備稼働状況表示
- [ ] WebSocket or ポーリング

### ✅ 現場の使いやすさを考慮しているか
- [ ] タブレット大画面UI
- [ ] QRコード/バーコード
- [ ] オフライン動作
- [ ] 音声フィードバック

---

## テンプレート使用方法

1. **このファイルをコピー**して、プロジェクト固有の要件を記入
2. **現場担当者にヒアリング**し、加工工程フローを確認
3. **不明な項目は「TODO」**と記載し、後で確認
4. **該当しない項目は「N/A」**と記載
5. 記入後、**AIに要件確認を依頼**:
   - 「この製造管理システム要件定義を確認し、曖昧な点・矛盾を指摘してください」
   - 「この要件に基づいてDjangoモデル設計（BOM階層構造）を開始してください」
   - 「MRP計算ロジックの実装方式を提案してください」
   - 「ガントチャート実装方式を提案してください」
   - 「タブレット画面のUI設計を提案してください」

---

**作成日**: 2025-12-08
**バージョン**: 1.0
**作成者**: [記入してください]
**想定システム**: 製造管理・生産管理・工程管理・品質管理（金属加工業特化）
